define(["jquery.ui","../../../../static/js/web/goods_selector.js"],function(e,c){var r,m={initnav:[],selected:"page"};function s(e,t){var i=r.indexOf(e.charAt(t));if(-1===i)throw"Cannot decode base64";return i}function d(e,t){for(;0<e.length;){var i=e[0];if(i<128)e.shift(),t.push(String.fromCharCode(i));else if(192==(128&i)){if(e.length<2)break;i=e.shift();var a=e.shift();t.push(String.fromCharCode(((31&i)<<6)+(63&a)))}else{if(e.length<3)break;i=e.shift();a=e.shift();var o=e.shift();t.push(String.fromCharCode(((15&i)<<12)+((63&a)<<6)+(63&o)))}}}return m.init=function(e){m.attachurl=e.attachurl,m.type=e.type,m.data=e.data,m.diyadvs=e.diyadvs,m.id=e.id,m.data?(m.page=m.data.page,m.items=m.data.items):(2==m.type&&(m.items=m.defaultItems()),3==m.type&&(m.items=m.defaultItems3()),4==m.type&&(m.items=m.defaultItems4()),5==m.type&&(m.items=m.defaultItems5())),m.initTpl(),m.initPage(),m.initItems(),m.initNavs(),m.initSortable(),m.initClick(),m.initWindow(),$(".diy-toolbar .btn-copy").unbind("click").click(function(e){var i=m.selected,t=m.items[i].id,a=JSON.parse(JSON.stringify(m.items[i]));if(delete a.name,a){var o=$("#tpl_show_"+t).length,l=$("#tpl_edit_"+t).length;if(0!=o&&0!=l)if("diymod"!==t){var n;i=m.getId("M",0);if(a.data){var s=JSON.parse(JSON.stringify(a.data)),r={},c=0;$.each(s,function(e,t){var i=m.getId("C",c);r[i]=t,delete i,c++}),a.data=r}if(a.max&&0<a.max)if(0<(n=m.getItemNum(t))&&n>=a.max)return void tip.msgbox.err("此元素最多允许添加 "+a.max+" 个");if(a.only&&"toptab"==a.only)if(0<(n=m.getItemOnlyNum(a.only)))return void tip.msgbox.err("已有顶部固定元素，请删除后再添加");var d=!0;if(m.selected&&"page"!=m.selected){var p=m.items[m.selected];"detail_navbar"!=p.id&&"detail_pullup"!=p.id&&"detail_navbar"!=t&&"detail_pullup"!=t||(d=!1)}if(a.istop)(f={})[i]=a,$.each(m.items,function(e,t){f[e]=t}),m.items=f;else if(m.selected&&"page"!=m.selected&&d){var f={};$.each(m.items,function(e,t){f[e]=t,e==m.selected&&(f[i]=a)}),m.items=f}m.initItems(),$(".drag[data-itemid='"+i+"']").trigger("mousedown").trigger("click"),m.selected=i}else m.initMod(a);else tip.msgbox.err("添加失败！模板错误，请刷新页面重试")}else tip.msgbox.err("未找到此元素！")}),$(".diy-toolbar .btn-del").unbind("click").click(function(e){var t=m.selected;console.log(t),$(this).closest(".drag").hasClass("nodelete")?tip.alert("此元素禁止删除"):tip.confirm("确定删除吗",function(){var e=m.getNear(t);delete m.items[t],m.initItems(),e?$(document).find(".drag[data-itemid='"+e+"']").trigger("mousedown"):$("#page").trigger("click")})})},m.initTpl=function(){tpl.helper("imgsrc",function(e){return"string"!=typeof e?"":0==e.indexOf("http://")||0==e.indexOf("https://")||0==e.indexOf("../addons/vcshop/")?e:0==e.indexOf("images/")||0==e.indexOf("audios/")||0==e.indexOf("videos/")?m.attachurl+e:void 0}),tpl.helper("decode",function(e){return $.base64.decode(e)}),tpl.helper("toArray",function(e){$.makeArray(e);var i=[];return $.each(e,function(e,t){i.push(t)}),i}),tpl.helper("count",function(e){return m.length(e)}),tpl.helper("define",function(e){})},m.initPage=function(e){void 0===e&&(e=!0),m.page?"5"!=m.type||m.page.seckill||(m.page.seckill={style:"style1",color:"red"}):(m.page={type:m.type,title:"请输入页面标题",name:"未命名页面",desc:"",icon:"",background:"#f3f3f3",titlebarbg:"#ffffff",titlebarcolor:"#000000"},"5"==m.type&&(m.page.seckill={style:"style1",color:"red"})),$("#page").text(m.page.title).css({color:m.page.titlebarcolor,backgroundColor:m.page.titlebarbg}),$("#phone").css({"background-color":m.page.background}),$("#phone").find(".drag").removeClass("selected"),m.page.seckill&&("style1"==m.page.seckill.style?$("#phone").addClass(m.page.seckill.style).removeClass("style2"):$("#phone").addClass(m.page.seckill.style).removeClass("style1"),$("#phone").closest(".phone-body").removeClass().addClass("phone-body").addClass(m.page.seckill.color)),e&&m.initEditor(),m.initTilteBg()},m.defaultItems=function(){return{M1506332563879:{params:{placeholder:"请输入关键字进行搜索"},style:{inputbackground:"#ffffff",background:"#f1f1f2",iconcolor:"#b4b4b4",color:"#999999",paddingtop:"10",paddingleft:"10",textalign:"left",searchstyle:""},id:"search"},M1506332568231:{style:{dotstyle:"round",dotalign:"center",background:"#ffffff",opacity:"0.8"},data:{C1506332568231:{imgurl:"../addons/vcshop/plugin/app/static/images/default/banner-1.jpg",linkurl:""},C1506332568232:{imgurl:"../addons/vcshop/plugin/app/static/images/default/banner-2.jpg",linkurl:""}},id:"banner"},M1506332575975:{params:{iconurl:"../addons/vcshop/static/images/hotdot.jpg",noticedata:"0",speed:"4",noticenum:"5"},style:{background:"#ffffff",iconcolor:"#fd5454",color:"#666666",bordercolor:"#e2e2e2"},data:{C1506332575975:{title:"这里是第一条自定义公告的标题",linkurl:""},C1506332575976:{title:"这里是第二条自定义公告的标题",linkurl:""}},id:"notice"},M1506332584255:{style:{navstyle:"",background:"#ffffff",rownum:"4",showtype:"0",pagenum:"8",showdot:"1"},data:{C1506332584255:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-1.png",linkurl:"",text:"按钮文字1",color:"#666666"},C1506332584256:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-2.png",linkurl:"",text:"按钮文字2",color:"#666666"},C1506332584257:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-3.png",linkurl:"",text:"按钮文字3",color:"#666666"},C1506332584258:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-4.png",linkurl:"",text:"按钮文字4",color:"#666666"}},id:"menu"},M1506332586927:{style:{navstyle:"",background:"#ffffff",rownum:"4",showtype:"0",pagenum:"8",showdot:"1"},data:{C1506332586927:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-1.png",linkurl:"",text:"按钮文字1",color:"#666666"},C1506332586928:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-2.png",linkurl:"",text:"按钮文字2",color:"#666666"},C1506332586929:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-3.png",linkurl:"",text:"按钮文字3",color:"#666666"},C1506332586930:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-4.png",linkurl:"",text:"按钮文字4",color:"#666666"}},id:"menu"},M1506332594040:{params:{showtitle:"1",showprice:"1",goodsdata:"0",cateid:"",catename:"",groupid:"",groupname:"",goodssort:"0",goodsscroll:"0",goodsnum:"6",showicon:"1",iconposition:"left top",productprice:"1",showproductprice:"0",showsales:"0",productpricetext:"原价",salestext:"销量",productpriceline:"0",saleout:"0"},style:{background:"#f3f3f3",liststyle:"block",buystyle:"buybtn-1",goodsicon:"recommand",iconstyle:"triangle",pricecolor:"#ff5555",productpricecolor:"#999999",iconpaddingtop:"0",iconpaddingleft:"0",buybtncolor:"#ff5555",iconzoom:"100",titlecolor:"#000000",tagbackground:"#fe5455",salescolor:"#999999"},data:{C1506332594040:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-1.jpg",price:"20.00",productprice:"99.00",title:"这里是商品标题",sales:"0",gid:"",ctype:"1"},C1506332594041:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-2.jpg",price:"20.00",productprice:"99.00",title:"这里是商品标题",sales:"0",gid:"",ctype:"1"},C1506332594042:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-3.jpg",price:"20.00",productprice:"99.00",sales:"0",title:"这里是商品标题",gid:"",ctype:"0"},C1506332594043:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-4.jpg",price:"20.00",productprice:"99.00",sales:"0",title:"这里是商品标题",gid:"",ctype:"0"}},id:"goods"}}},m.defaultItems3=function(){return{M1519884909408:{type:"3",params:{style:"default1",leftnav:"充值",rightnav:"兑换"},style:{background:"#fe5455",textcolor:"#ffffff",textlight:"#fef31f",headstyle:""},id:"member"},M1519884912926:{style:{margintop:"9",titlecolor:"#ff0011",textcolor:"#999999",iconcolor:"#999999"},params:{title:"绑定手机号",text:"如果您用手机号注册过会员或您想通过微信外购物请绑定您的手机号码",iconclass:"icon-shouji"},id:"bindmobile"},M1519884989438:{style:{margintop:"10",background:"#ffffff",iconcolor:"#999999",textcolor:"#000000",remarkcolor:"#888888"},data:{C1519884989438:{text:"我的订单",linkurl:"/pages/order/index",iconclass:"icox-shop",remark:"查看",dotnum:""}},id:"listmenu"},M1519884959829:{params:{rownum:"4",border:"1",bordertop:"1",borderbottom:"1"},style:{background:"#ffffff",bordercolor:"#ffffff",textcolor:"#000000",iconcolor:"#666666",dotcolor:"#ff0011"},data:{C1519884959829:{iconclass:"icox-daifukuan1",text:"待付款",linkurl:"",dotnum:"0"},C1519884959830:{iconclass:"icox-daifahuo1",text:"待发货",linkurl:"",dotnum:"0"},C1519884959831:{iconclass:"icox-daishouhuo1",text:"待收货",linkurl:"",dotnum:"0"},C1519884959832:{iconclass:"icox-daituikuan2",text:"退换货",linkurl:"",dotnum:"0"}},id:"icongroup"},M1519885061238:{style:{margintop:"10",background:"#ffffff",iconcolor:"#999999",textcolor:"#000000",remarkcolor:"#888888"},data:{C1519885061238:{text:"我的购物车",linkurl:"",iconclass:"icox-shop",remark:"查看",dotnum:""},C1519885061239:{text:"我的关注",linkurl:"",iconclass:"icox-shop",remark:"查看",dotnum:""},C1519885061240:{text:"我的足迹",linkurl:"",iconclass:"icox-shop",remark:"查看",dotnum:""}},id:"listmenu"},M1520230074322:{isbottom:"1",max:"1",style:{showtype:"0"},params:{showimg:"1",copyright:"版权所有 XXX商城",imgurl:"../addons/vcshop/plugin/app/static/images/default/copyright.png"},id:"copyright"}}},m.defaultItems4=function(){return{M1519886070303:{type:"4",max:"1",style:{dotstyle:"rectangle",dotalign:"left",background:"#ffffff",leftright:"5",bottom:"5",opacity:"0.8"},id:"detail_swipe"},M1519886077750:{type:"4",max:"1",params:{},style:{theme:"red"},id:"detail_seckill"},M1519886077751:{type:"4",max:"1",params:{hideshare:"0",share:"分享",share_link:"",share_icon:"icon-share"},style:{margintop:"0",marginbottom:"0",background:"#ffffff",titlecolor:"#000000",subtitlecolor:"#999999",pricecolor:"#ff5555",textcolor:"#cccccc",timecolor:"#fff2e2",timetextcolor:"#ef4f4f"},id:"detail_info"},M1519886083903:{type:"4",max:"1",style:{margintop:"0",marginbottom:"0",background:"#ffffff",textcolor:"#666666",textcolorhigh:"#ef4f4f"},data:{C1519886083903:{name:"商品预售",type:"yushou"},C1519886083904:{name:"二次购买",type:"erci"},C1519886083905:{name:"会员价",type:"huiyuan"},C1519886083906:{name:"优惠",type:"youhui"},C1519886083907:{name:"积分",type:"jifen"},C1519886083908:{name:"不配送区域",type:"bupeisong"},C1519886083909:{name:"商品标签",type:"biaoqian"},C1519886083910:{name:"可用优惠券",type:"coupon"},C1519886083911:{name:"全返",type:"fullback"}},id:"detail_sale"},M1519886090456:{type:"4",max:"1",style:{background:"#ffffff",textcolor:"#333333",margintop:"10",marginbottom:"0"},id:"detail_spec"},M1519886113758:{type:"4",max:"1",params:{shoplogo:"../addons/vcshop/static/images/designer.jpg",shopname:"",shopdesc:"",hidenum:"0",leftnavtext:"全部商品",leftnavlink:"",rightnavtext:"进店逛逛",rightnavlink:""},style:{margintop:"10",marginbottom:"0",background:"#ffffff",goodsnumcolor:"#333333",goodstextcolor:"#7c7c7c",rightnavcolor:"#ff5555",shopnamecolor:"#333333",shopdesccolor:"#444444"},id:"detail_shop"},M1519886128767:{type:"4",max:"1",params:{hidelike:"0",hideshop:"0",hidecart:"0",hidecartbtn:"0",textbuy:"立刻购买",goodstext:"商品",liketext:"关注",likeiconclass:"icox-like",likelink:"icox-like",shoptext:"店铺",shopiconclass:"icox-shop",carttext:"购物车",carticonclass:"icox-cart"},style:{background:"#ffffff",textcolor:"#999999",iconcolor:"#999999",cartcolor:"#fe9402",buycolor:"#fd5555",dotcolor:"#ff0011"},id:"detail_navbar"}}},m.defaultItems5=function(){return{M1519886070302:{type:"5",max:"1",noEdit:!0,style:{},id:"seckill_times"},M1519886077750:{type:"5",max:"1",noEdit:!0,params:{},style:{},id:"seckill_rooms"},M1519886083902:{type:"5",max:"1",style:{},data:{C1506342568231:{imgurl:"../addons/vcshop/plugin/app/static/images/default/goods-1.jpg",linkurl:""},C1506342568232:{imgurl:"../addons/vcshop/plugin/app/static/images/default/goods-2.jpg",linkurl:""},C1506342568233:{imgurl:"../addons/vcshop/plugin/app/static/images/default/goods-3.jpg",linkurl:""}},id:"seckill_advs"},M1519886090455:{type:"5",max:"1",noEdit:!0,style:{},id:"seckill_list"}}},m.initTilteBg=function(){var e=$("#page")[0].style.backgroundColor.replace("rgb(","").replace(")","").split(","),t=192<.299*e[0]+.587*e[1]+.114*e[2]?"wx-top2":"wx-top";$("#page").css("background-image",'url("../addons/vcshop/plugin/app/static/images/'+t+'.png")')},m.initItems=function(e){var t=$("#phone");if(m.items){t.empty(),$.each(m.items,function(e,t){if(void 0!==t.id){var i=$.extend(!0,{},t);i.itemid=e;var a=tpl("tpl_show_"+t.id,i);$("#phone").append(a)}});var i=$("#edit-del").html();$("#phone .drag").append(i),$("#phone .drag .btn-edit-del .btn-del").unbind("click").click(function(e){e.stopPropagation();var t=$(this).closest(".drag").data("itemid");$(this).closest(".drag").hasClass("nodelete")?tip.alert("此元素禁止删除"):tip.confirm("确定删除吗",function(){var e=m.getNear(t);delete m.items[t],m.initItems(),e?$(document).find(".drag[data-itemid='"+e+"']").trigger("mousedown"):$("#page").trigger("click")})}),e&&m.selectedItem(e)}else m.items={}},m.initNavs=function(){m.setNavs();var e={0:["listmenu","richtext","title","line","blank","menu","menu2","picture","banner","picturew","coupon","tabbar","topmenu"],2:["notice","goods","search","fixedsearch","seckillgroup","copyright","video","groupsgoods"],20:["notice","goods","search","fixedsearch","pictures","icongroup","audio","copyright","video","groupsgoods"],3:["member","bindmobile","notice","verify","pictures","icongroup","audio","copyright"],4:["detail_swipe","detail_seckill","detail_info","detail_sale","detail_spec","detail_package","detail_shop","detail_buyshow","detail_navbar","pictures","icongroup","audio","goods","copyright","groupsgoods"],5:["seckill_times","seckill_rooms","seckill_advs","seckill_list","audio","icongroup","pictures"]},g=e[m.type],a=[],o=m.type;g=g?$.merge(g,e[0]):e[0],$.each(g,function(e,t){var i=m.navs[t];if(i){if(4==o&&"tabbar"==t)return;if(i.id=t,i.global)return void a.push(i);m.initnav.push(i)}});var t=tpl("tpl_navs",{basic:m.initnav,global:a,navpageType:o});$("#navs").html(t).show(),$("#navs nav").unbind("click").click(function(){var e=$(this).data("id");if("page"!==e)if($.inArray(e,g)<0)tip.msgbox.err("此页面类型禁止添加此元素！");else{var i=$.extend(!0,{},m.navs[e]);if(i){delete i.name;var t=$("#tpl_show_"+e).length,a=$("#tpl_edit_"+e).length;if(0!=t&&0!=a){var o,l=m.getId("M",0);if(i.data){var n=$.extend(!0,{},i.data),s={},r=0;$.each(n,function(e,t){var i=m.getId("C",r);s[i]=t,delete i,r++}),i.data=s}if(i.max&&0<i.max)if(0<(o=m.getItemNum(e))&&o>=i.max)return void tip.msgbox.err("此元素最多允许添加 "+i.max+" 个");if(i.only&&"toptab"==i.only)if(0<(o=m.getItemOnlyNum(i.only)))return void tip.msgbox.err("已有顶部固定元素，请删除后再添加");var c=!0;if(m.selected&&"page"!=m.selected){var d=m.items[m.selected];"detail_navbar"!=d.id&&"detail_pullup"!=d.id&&"detail_navbar"!=e&&"detail_pullup"!=e||(c=!1)}if(i.istop)(p={})[l]=i,$.each(m.items,function(e,t){p[e]=t}),m.items=p;else if(m.selected&&"page"!=m.selected&&c){var p={};$.each(m.items,function(e,t){p[e]=t,e==m.selected&&(p[l]=i)}),m.items=p}else if(4==m.page.type&&m.items&&"detail_navbar"!=e){var f=null,u=null;$.each(m.items,function(e,t){"detail_navbar"==t.id?(f={itemid:e,item:t},delete m.items[e]):"detail_pullup"==t.id&&(u={itemid:e,item:t},delete m.items[e])}),m.items[l]=i,u&&(m.items[u.itemid]=u.item),f&&(m.items[f.itemid]=f.item)}else m.items[l]=i;m.initItems(),$(".drag[data-itemid='"+l+"']").trigger("mousedown").trigger("click"),m.selected=l}else tip.msgbox.err("添加失败！模板错误，请刷新页面重试")}else tip.msgbox.err("未找到此元素！")}else $("#page").trigger("click")})},m.setNavs=function(){m.navs={notice:{name:"公告",params:{iconurl:"../addons/vcshop/static/images/hotdot.jpg",noticedata:"0",speed:"4",noticenum:"5"},style:{background:"#ffffff",iconcolor:"#fd5454",color:"#666666",bordercolor:"#e2e2e2"},data:{C0123456789101:{title:"这里是第一条自定义公告的标题",linkurl:""},C0123456789102:{title:"这里是第二条自定义公告的标题",linkurl:""}}},title:{name:"标题栏",params:{title:"",icon:""},style:{background:"#ffffff",color:"#666666",textalign:"left",fontsize:"12",paddingtop:"5",paddingleft:"5"}},search:{name:"搜索框",params:{placeholder:"请输入关键字进行搜索"},style:{inputbackground:"#ffffff",background:"#f1f1f2",iconcolor:"#b4b4b4",color:"#999999",paddingtop:"10",paddingleft:"10",textalign:"left",searchstyle:""}},fixedsearch:{name:"固定搜索框",istop:2,max:1,only:"toptab",params:{leftnav:1,rightnav:1,rightnavclick:0,leftnavicon:"icox-shop",rightnavicon:"icox-cart",searchstyle:"round",placeholder:"输入关键字进行搜索"},style:{background:"#000000",opacity:.8,opacityinput:.8,leftnavcolor:"#ffffff",rightnavcolor:"#ffffff",searchbackground:"#ffffff",searchtextcolor:"#666666"}},line:{name:"辅助线",params:{},style:{height:2,background:"#ffffff",border:"#000000",padding:10,linestyle:"solid"}},blank:{name:"辅助空白",params:{},style:{height:20,background:"#ffffff"}},menu:{name:"按钮组",params:{},style:{navstyle:"",background:"#ffffff",rownum:4,showtype:0,pagenum:8,showdot:1},data:{C0123456789101:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-1.png",linkurl:"",text:"按钮文字1",color:"#666666"},C0123456789102:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-2.png",linkurl:"",text:"按钮文字2",color:"#666666"},C0123456789103:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-3.png",linkurl:"",text:"按钮文字3",color:"#666666"},C0123456789104:{imgurl:"../addons/vcshop/plugin/app/static/images/default/icon-4.png",linkurl:"",text:"按钮文字4",color:"#666666"}}},menu2:{name:"按钮组2",params:{},style:{margintop:10,background:"#ffffff"},data:{C0123456789101:{text:"我的积分",iconclass:"",textcolor:"#666666",iconcolor:"#666666",linkurl:""},C0123456789102:{text:"兑换记录",iconclass:"",textcolor:"#666666",iconcolor:"#666666",linkurl:""}}},listmenu:{name:"列表导航",params:{},style:{margintop:10,background:"#ffffff",iconcolor:"#999999",textcolor:"#000000",remarkcolor:"#888888"},data:{C0123456789101:{text:"文字1",linkurl:"",iconclass:"icox-shop",remark:"查看",dotnum:""},C0123456789102:{text:"文字2",linkurl:"",iconclass:"icox-shop",remark:"查看",dotnum:""},C0123456789103:{text:"文字3",linkurl:"",iconclass:"icox-shop",remark:"查看",dotnum:""}}},picture:{name:"单图组",params:{},style:{paddingtop:0,paddingleft:0,background:"#ffffff"},data:{C0123456789101:{imgurl:"../addons/vcshop/plugin/app/static/images/default/banner-1.jpg",linkurl:""},C0123456789102:{imgurl:"../addons/vcshop/plugin/app/static/images/default/banner-2.jpg",linkurl:""}}},picturew:{name:"图片橱窗",params:{row:4,showtype:0,pagenum:2},style:{background:"#ffffff",paddingtop:0,paddingleft:0,showdot:0,showbtn:0},data:{C0123456789101:{imgurl:"../addons/vcshop/plugin/app/static/images/default/cube-1.jpg",linkurl:""},C0123456789102:{imgurl:"../addons/vcshop/plugin/app/static/images/default/cube-2.jpg",linkurl:""},C0123456789103:{imgurl:"../addons/vcshop/plugin/app/static/images/default/cube-3.jpg",linkurl:""},C0123456789104:{imgurl:"../addons/vcshop/plugin/app/static/images/default/cube-4.jpg",linkurl:""}}},pictures:{name:"图片展播",params:{hidetext:0,showtype:0,rownum:3,showbtn:0},style:{background:"#ffffff",paddingtop:"3",paddingleft:"5",titlealign:"left",textalign:"left",titlecolor:"#ffffff",textcolor:"#666666"},data:{C0123456789101:{imgurl:"../addons/vcshop/plugin/diypage/static/images/default/goods-1.jpg",linkurl:"",title:"这里是上标题",text:"这里是下标题"},C0123456789102:{imgurl:"../addons/vcshop/plugin/diypage/static/images/default/goods-2.jpg",linkurl:"",title:"这里是上标题",text:"这里是下标题"},C0123456789103:{imgurl:"../addons/vcshop/plugin/diypage/static/images/default/goods-4.jpg",linkurl:"",title:"这里是上标题",text:"这里是下标题"}}},banner:{name:"图片轮播",params:{},style:{dotstyle:"round",dotalign:"center",background:"#ffffff",opacity:"0.8"},data:{C0123456789101:{imgurl:"../addons/vcshop/plugin/app/static/images/default/banner-1.jpg",linkurl:""},C0123456789102:{imgurl:"../addons/vcshop/plugin/app/static/images/default/banner-2.jpg",linkurl:""}}},icongroup:{name:"图标组",params:{rownum:"4",border:"1",bordertop:"1",borderbottom:"1"},style:{background:"#ffffff",bordercolor:"#ffffff",textcolor:"#000000",iconcolor:"#666666",dotcolor:"#ff0011"},data:{C0123456789101:{iconclass:"icox-daifukuan1",text:"待付款",linkurl:"",dotnum:0},C0123456789102:{iconclass:"icox-daifahuo1",text:"待发货",linkurl:"",dotnum:0},C0123456789103:{iconclass:"icox-daishouhuo1",text:"待收货",linkurl:"",dotnum:0},C0123456789104:{iconclass:"icox-daituikuan2",text:"退换货",linkurl:"",dotnum:0}}},audio:{name:"音频播放",params:{title:"未定义音频信息",subtitle:"副标题",playerstyle:0,autoplay:0,loopplay:0,pausestop:0,headalign:"left",headtype:"",headurl:"",audiodefaultimg:"../addons/vcshop/plugin/app/static/images/audio.png"},style:{background:"#f1f1f1",bordercolor:"#ededed",textcolor:"#333333",subtitlecolor:"#666666",timecolor:"#666666",paddingtop:"0",paddingleft:"0",width:"0"}},coupon:{name:"优惠券组",params:{couponstyle:"3"},style:{background:"#ffffff",margintop:10,marginleft:5},data:{C0123456789101:{name:"优惠券名称",desc:"满100元可用",price:"89.90",couponid:"",couponcolor:"#55b5ff"},C0123456789102:{name:"优惠券名称",desc:"满100元可用",price:"89.90",couponid:"",couponcolor:"#ff5555"},C0123456789103:{name:"优惠券名称",desc:"满100元可用",price:"89.90",couponid:"",couponcolor:"#ff913f"}}},richtext:{name:"富文本",params:{content:""},style:{background:"#ffffff",padding:0}},goods:{name:"商品组",params:{showtitle:1,showprice:1,goodsdata:0,cateid:"",catename:"",groupid:"",groupname:"",goodssort:0,goodsscroll:0,goodsnum:6,showicon:1,iconposition:"left top",productprice:1,showproductprice:0,showsales:0,productpricetext:"原价",salestext:"销量",productpriceline:0,saleout:0,seecommission:0,cansee:0,seetitle:"",pagetype:m.page.type},style:{background:"#f3f3f3",liststyle:"block",buystyle:"buybtn-1",goodsicon:"recommand",iconstyle:"triangle",pricecolor:"#ff5555",productpricecolor:"#666666",iconpaddingtop:"0",iconpaddingleft:"0",buybtncolor:"#ff5555",groupscorner:"#ff5555",iconzoom:"100",titlecolor:"#000000",tagbackground:"#fe5455",productpricecolor:"#999999",salescolor:"#999999"},data:{C0123456789101:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-1.jpg",price:"20.00",productprice:"99.00",title:"这里是商品标题",sales:0,gid:"",ctype:1},C0123456789102:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-2.jpg",price:"20.00",productprice:"99.00",title:"这里是商品标题",sales:0,gid:"",ctype:1},C0123456789103:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-3.jpg",price:"20.00",productprice:"99.00",sales:0,title:"这里是商品标题",gid:"",ctype:0},C0123456789104:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-4.jpg",price:"20.00",productprice:"99.00",sales:0,title:"这里是商品标题",gid:"",ctype:0}}},groupsgoods:{max:1,name:"拼团商品组",params:{showtitle:1,showprice:1,goodsdata:0,cateid:"",catename:"",groupid:"",groupname:"",goodssort:0,goodsscroll:0,goodsnum:6,showicon:1,iconposition:"left top",productprice:1,showproductprice:1,showsales:0,productpricetext:"原价",salestext:"销量",productpriceline:0,saleout:0,seecommission:0,cansee:0,seetitle:"",pagetype:m.page.type},style:{background:"#f3f3f3",liststyle:"block",buystyle:"buybtn-1",goodsicon:"recommand",iconstyle:"triangle",pricecolor:"#ff5555",productpricecolor:"#666666",iconpaddingtop:"0",iconpaddingleft:"0",buybtncolor:"#ff5555",iconzoom:"100",titlecolor:"#000000",tagbackground:"#fe5455",productpricecolor:"#999999",salescolor:"#999999"},data:{C0123456789101:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-1.jpg",price:"20.00",productprice:"99.00",title:"这里是商品标题",sales:0,gid:"",ctype:1},C0123456789102:{thumb:"../addons/vcshop/plugin/app/static/images/default/goods-2.jpg",price:"20.00",productprice:"99.00",title:"这里是商品标题",sales:0,gid:"",ctype:1}}},video:{name:"视频组",style:{ratio:0},params:{videourl:"",poster:""}},copyright:{name:"版权",isbottom:1,max:1,style:{showtype:0},params:{showimg:"1",copyright:"请填写版权说明",imgurl:"../addons/vcshop/plugin/app/static/images/default/copyright.png"}},tabbar:{name:"选项卡",style:{background:"#ffffff",color:"#666666",activebackground:"#ffffff",activecolor:"#ef4f4f",scrollnum:5,showtype:1},data:{C0123456789101:{text:"选项",linkurl:""},C0123456789102:{text:"选项",linkurl:""},C0123456789103:{text:"选项",linkurl:""},C0123456789104:{text:"选项",linkurl:""},C0123456789105:{text:"选项",linkurl:""}}},topmenu:{name:"顶部菜单",istop:1,max:1,only:"toptab",global:!0,style:{background:"#ffffff",color:"#666666",activebackground:"#ffffff",activecolor:"#ef4f4f",scrollnum:5,showtype:1},params:{datatype:null},data:{C0123456789101:{text:"选项",linkurl:""},C0123456789102:{text:"选项",linkurl:""},C0123456789103:{text:"选项",linkurl:""},C0123456789104:{text:"选项",linkurl:""},C0123456789105:{text:"选项",linkurl:""}}},member:{type:3,name:"会员信息",params:{style:"default1",leftnav:"充值",rightnav:"兑换"},style:{background:"#fe5455",textcolor:"#ffffff",textlight:"#fef31f",headstyle:""}},bindmobile:{type:3,name:"绑定手机",style:{margintop:"9",titlecolor:"#ff0011",textcolor:"#999999",iconcolor:"#999999"},params:{title:"绑定手机号",text:"如果您用手机号注册过会员或您想通过微信外购物请绑定您的手机号码",iconclass:"icon-shouji"}},logout:{type:3,name:"退出登录",style:{margintop:"10",subcolor:"#ffffff",maincolor:"#ff5555"},params:{}},verify:{type:3,name:"待使用商品",style:{titlebg:"#ffffff",titlecolor:"#333333",remarkcolor:"#888888",background:"#ffffff"},params:{iconclass:"icon-list",style:"",title:"待使用商品",remark:""}},detail_swipe:{name:"商品图",type:4,max:1,params:{},style:{dotstyle:"rectangle",dotalign:"left",background:"#ffffff",leftright:"5",bottom:"5",opacity:"0.8"}},detail_seckill:{name:"秒杀条",type:4,max:1,params:{},style:{theme:"red"}},detail_info:{name:"商品信息",type:4,max:1,params:{hideshare:"0",share:"分享",share_link:"",share_icon:"icon-share"},style:{margintop:0,marginbottom:0,background:"#ffffff",titlecolor:"#000000",subtitlecolor:"#999999",pricecolor:"#ff5555",textcolor:"#cccccc",timecolor:"#fff2e2",timetextcolor:"#ef4f4f"}},detail_sale:{name:"营销信息",type:4,max:1,params:{},style:{margintop:0,marginbottom:0,background:"#ffffff",textcolor:"#666666",textcolorhigh:"#ef4f4f"},data:{C0123456789100:{name:"商品预售",type:"yushou"},C0123456789101:{name:"二次购买",type:"erci"},C0123456789102:{name:"会员价",type:"huiyuan"},C0123456789103:{name:"优惠",type:"youhui"},C0123456789104:{name:"积分",type:"jifen"},C0123456789105:{name:"不配送区域",type:"bupeisong"},C0123456789106:{name:"商品标签",type:"biaoqian"},C0123456789107:{name:"可用优惠券",type:"coupon"},C0123456789108:{name:"赠品",type:"zengpin"},C0123456789108:{name:"全返",type:"fullback"}}},detail_spec:{name:"商品规格",type:4,max:1,params:{},style:{background:"#ffffff",textcolor:"#333333",margintop:10,marginbottom:0}},detail_shop:{name:"店铺信息",type:4,max:1,params:{shoplogo:"../addons/vcshop/static/images/designer.jpg",shopname:"",shopdesc:"",hidenum:0,leftnavtext:"全部商品",leftnavlink:"",rightnavtext:"进店逛逛",rightnavlink:""},style:{margintop:10,marginbottom:0,background:"#ffffff",goodsnumcolor:"#333333",goodstextcolor:"#7c7c7c",rightnavcolor:"#ff5555",shopnamecolor:"#333333",shopdesccolor:"#444444"}},detail_comment:{name:"商品评价",type:4,max:0,params:{},style:{margintop:10,marginbottom:10,background:"#ffffff",maincolor:"#fd5454",subcolor:"#000",textcolor:"#333333"}},detail_buyshow:{name:"购买可见",type:4,max:1,params:{},style:{background:"#ffffff",margintop:10,marginbottom:0}},detail_package:{name:"相关套餐",type:4,max:1,params:{},style:{background:"#ffffff",margintop:10,marginbottom:0,textcolor:"#000000"}},detail_navbar:{name:"底部导航",type:4,max:1,params:{hidelike:0,hideshop:0,hidecart:0,hidecartbtn:0,textbuy:"立刻购买",goodstext:"商品",liketext:"关注",likeiconclass:"icon-like",likelink:"icon-like",shoptext:"店铺",shopiconclass:"icon-shop",carttext:"购物车",carticonclass:"icon-cart"},style:{background:"#ffffff",textcolor:"#999999",iconcolor:"#999999",cartcolor:"#fe9402",buycolor:"#fd5555",dotcolor:"#ff0011"}},seckillgroup:{max:1,name:"秒杀组",params:{iconurl:"../addons/vcshop/plugin/diypage/static/images/default/seckill.png",hideborder:0,tag:""},style:{margintop:"10",titlecolor:"#ff3300",marketpricecolor:"#ef4f4f",productpricecolor:"#999999"}},seckill_times:{name:"秒杀时间段",noEdit:!0,max:1,type:5},seckill_rooms:{name:"秒杀会场",noEdit:!0,max:1,type:5},seckill_advs:{name:"秒杀广告",data:{C0123456789101:{imgurl:"../addons/vcshop/plugin/app/static/images/default/goods-1.jpg",linkurl:""},C0123456789102:{imgurl:"../addons/vcshop/plugin/app/static/images/default/goods-2.jpg",linkurl:""},C0123456789103:{imgurl:"../addons/vcshop/plugin/app/static/images/default/goods-3.jpg",linkurl:""}},max:1,type:5},seckill_list:{name:"秒杀商品",noEdit:!0,max:1,type:5}}},m.initClick=function(){$(".btn-save").unbind("click").click(function(){var e=$(this).data("type"),t=$(this).data("id");if($(this).attr("stop"))tip.msgbox.err("正在保存，请稍候...");else if("isdefault"==e){if(2==t)var i="首页";else if(3==t)i="会员中心";else i="商品详情";tip.confirm("确定要保存并设为默认"+i+"吗?",function(){m.save(!0,t)})}else"save"==e?m.save():"cancel_default"==e&&m.cancel_default()}),$("#page").unbind("click").click(function(){"page"!=m.selected&&(m.selected="page",m.initPage())})},m.initSortable=function(){$("#phone").sortable({opacity:.8,placeholder:"highlight",items:".drag:not(.fixed)",revert:100,scroll:!1,start:function(e,t){var i=t.item.height();$(".highlight").css({height:i+"px"}),$(".highlight").html('<div><i class="fa fa-plus"></i> 放置此处</div>'),$(".highlight div").css({"line-height":i-4+"px"})},stop:function(e,t){m.initEditor()},update:function(e,t){m.sortItems()}}),$("#phone").disableSelection(),$(document).on("mousedown","#phone .drag",function(){$(this).hasClass("selected")||(m.selected=$(this).data("itemid"),$("#phone").find(".drag").removeClass("selected"),$(this).addClass("selected"),m.selected=$(this).data("itemid"),m.initEditor())})},m.initSortableChild=function(){$("#diy-editor .inner").sortable({opacity:.8,placeholder:"highlight",items:".item",revert:100,scroll:!1,cancel:".goods-selector,input,select,.btn,btn-del",start:function(e,t){var i=t.item.height();$(".highlight").css({height:i+22+"px"}),$(".highlight").html('<div><i class="fa fa-plus"></i> 放置此处</div>'),$(".highlight div").css({"line-height":i+16+"px"})},update:function(e,t){m.sortChildItems()}})},m.sortItems=function(){var t={};$("#phone .drag").each(function(){var e=$(this).data("itemid");t[e]=m.items[e]}),m.items=t},m.sortChildItems=function(){var t={},i=m.selected;$("#diy-editor .form-items .item").each(function(){var e=$(this).data("id");t[e]=m.items[i].data[e]}),m.items[i].data=t,m.initItems(i)},m.initEditor=function(e,t){void 0===e&&(e=!0);var d=m.selected,i=180;if("page"!=m.selected){var a=$(".phone-main").children(".selected").position().top;i=a||0,0<$(".wb-header").length?i+=210:i-=30}if(e&&(console.log(e),console.log(i-130),$("#diy-editor").unbind("animate").animate({"margin-top":i-130+"px"}),setTimeout(function(){$("body").unbind("animate").animate({scrollTop:i-130+"px"},1e3)},1e3)),m.selected)if("page"==m.selected){var o=tpl("tpl_edit_page",m);$("#diy-editor .inner").html(o),$("#diy-editor").attr("data-editid",m.selected).show(),$("#diy-editor").css("opacity",1)}else{var l=$.extend(!0,{},m.items[m.selected]);if(l.itemid=m.selected,l.merch=m.merch,l.plugins=m.plugins,l.noEdit)$("#diy-editor").css("opacity",0);else{o=tpl("tpl_edit_"+l.id,l);$("#diy-editor .inner").html(o),$("#diy-editor").attr("data-editid",m.selected).show(),$("#diy-editor").css("opacity",1)}}if(0<$("#diy-editor .slider").length&&$("#diy-editor .slider").each(function(){var a=$(this).data("decimal"),e=($(this).data("multiply"),$(this).data("value"));a&&(e*=a),$(this).slider({slide:function(e,t){var i=t.value;a&&(i/=a),$(this).siblings(".input").val(i).trigger("propertychange"),$(this).siblings(".count").find("span").text(i)},value:e,min:$(this).data("min"),max:$(this).data("max")})}),0<$("#diy-editor .coupon-selector").length){var n=$("#diy-editor .coupon-selector"),s=biz.url("sale/coupon/query",{diy:1},m.merch);n.attr({id:"coupon_selector","data-url":s,"data-callback":"callbackCoupon"}),n.unbind("click").click(function(){biz.selector.select({name:"coupon",autosearch:1,url:s}),m.childid=$(this).closest(".item").data("id")})}if(0<$("#diy-editor .goods-selector").length){var r=2==(n=$("#diy-editor .goods-selector")).data("pagetype")?2:0;n.unbind("click").click(function(){m.childid=$(this).closest(".item").data("id"),c.open("callbackGoods",r,m.merch,"","","","","wxapp")})}if(0<$("#diy-editor .category-selector").length){n=$("#diy-editor .category-selector"),s=biz.url("goods/category/query",null,m.merch);n.attr({id:"category_selector","data-url":s,"data-callback":"callbackCategory"}),n.unbind("click").click(function(){biz.selector.select({name:"category",autosearch:1,url:s})})}if(0<$("#diy-editor .group-selector").length){n=$("#diy-editor .group-selector"),s=biz.url("goods/group/query",null,m.merch);n.attr({id:"group_selector","data-url":s,"data-callback":"callbackGroup"}),n.unbind("click").click(function(){biz.selector.select({name:"group",autosearch:1,url:s})})}if(0<$("#diy-editor .form-items").length&&(m.initSortableChild(),$("#addChild").unbind("click").click(function(){var e=m.selected,t=m.items[e].id,i=m.navs[t].data,a=$(this).closest(".form-items").data("max");if(a&&a<=m.length(m.items[e].data))return void tip.msgbox.err("最大添加 "+a+" 个！");var o={},l=0;if($.each(i,function(e,t){0==l&&(o=t,l++)}),o){var n=m.getId("M",0);void 0===m.items[e].data&&(m.items[e].data={}),o=$.extend(!0,{},o),m.items[e].data[n]=o}m.initItems(e),m.initEditor(!1)}),$("#diy-editor .form-items .item .btn-del").unbind("click").click(function(){var e=$(this).closest(".item").data("id"),t=m.selected,i=$(this).closest(".form-items").data("min");if(i&&m.length(m.items[t].data)<=i)return void tip.msgbox.err("至少保留 "+i+" 个！");tip.confirm("确定删除吗",function(){delete m.items[t].data[e],m.initItems(t),m.initEditor(!1)})})),0<$("#diy-editor .nav-tabs").length){t&&($("#diy-editor .nav-tabs a[data-tab="+t+"]").closest("li").addClass("active").siblings().removeClass("active"),$("#diy-editor .tab-content").hide(),$("#diy-editor .tab-content[data-tab="+t+"]").show()),$("#diy-editor .nav-tabs a").click(function(){$(this).closest("li").addClass("active").siblings().removeClass("active");var e=$(this).data("tab");$("#diy-editor .tab-content").hide(),$("#diy-editor .tab-content[data-tab="+e+"]").show()});var p=!0}else p=!1;m.initRichtext(d),$("#diy-editor").find(".diy-bind").bind("input propertychange change",function(){var e=$(this),t=e.data("bind"),i=e.data("bind-child"),a=e.data("bind-parent"),o=e.data("bind-init"),l="",n=this.tagName;if(d||m.selectedItem("page"),"INPUT"==n)if("checkbox"==e.attr("type"))l=[],e.closest(".form-group").find("input[type=checkbox]").each(function(){var e=this.checked,t=$(this).val();e&&l.push(t)});else{var s=e.data("placeholder");l=""==(l=e.val())?s:l}else"SELECT"==n?l=e.find("option:selected").val():"TEXTAREA"==n&&(l=e.val());if(l=$.trim(l),"seckill"==i&&("style"==t&&(m.page.titlebarbg="style2"==l?$(".swiper-slide.room-slide.selected").css("color"):"#ffffff"),"color"==t&&"style2"==m.page.seckill.style)){var r="";switch(l){case"blue":r="#4e87ee";break;case"purple":r="#a839fa";break;case"orange":r="#ff8c1e";break;case"pink":r="#ff7e95";break;case"red":r="#ff5555";break;default:r="#ffffff"}m.page.titlebarbg=r}if("page"==d?(i?(m.page[i]||(m.page[i]={}),m.page[i][t]=l):m.page[t]=l,m.initPage(!1)):(i?a?m.items[d][a][i][t]=l:m.items[d][i][t]=l:m.items[d][t]=l,m.initItems(d)),o){var c=!1;p&&(c=$("#diy-editor .nav-tabs li.active a").data("tab")||!1),m.initEditor(!1,c)}}),$("#diy-editor").find('[data-toggle="resetColor"]').bind("click",function(){var e=$(this).data("color")||"#000000";$(this).prev().val(e).trigger("propertychange")}),$("#diy-editor").find('[data-toggle="setNull"]').bind("click",function(){var e=$(this).data("element");$(e).val("").trigger("propertychange")}),$("#diy-editor").find('[data-toggle="selectIcon3"]').unbind("click").bind("click",function(){var i=$(this).data("element"),a=$(this).data("input");if(a||i){var e=biz.url("app/page/selecticon3");$.ajax(e,{type:"get",dataType:"html",cache:!1}).done(function(e){var t=$("#selectIcon3");t.length||(console.log(t),$(document.body).append($('<div class="modal fade" id="selectIcon3"></div>'))),t.modal("show"),t.append2(e,function(){$(document).off("click","#selectIcon3 nav").on("click","#selectIcon3 nav",function(){var e=$.trim($(this).data("class"));a&&$(a).val(e).trigger("change"),i&&$(i).removeAttr("class").addClass("icox "+e),t.find(".close").click()})})})}})},m.initRichtext=function(t){if(0<$("#diy-editor .form-richtext").length&&t){var e={autoClearinitialContent:!1,toolbars:[["fullscreen","source","preview","|","bold","italic","underline","strikethrough","forecolor","backcolor","|","justifyleft","justifycenter","justifyright","|","insertorderedlist","insertunorderedlist","blockquote","emotion","removeformat","|","rowspacingtop","rowspacingbottom","lineheight","indent","paragraph","fontsize","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","|","drafts","|"]],elementPathEnabled:!1,initialFrameHeight:300,focus:!1,maximumWords:9999999999999};console.log(e);var l={type:"image",direct:!1,multiple:!0,tabs:{upload:"active",browser:"",crawler:""},path:"",dest_dir:"",global:!1,thumb:!1,width:0};UE.registerUI("myinsertimage",function(a,t){a.registerCommand(t,{execCommand:function(){require(["fileUploader"],function(e){e.show(function(e){if(0!=e.length)if(1==e.length)a.execCommand("insertimage",{src:e[0].url,_src:e[0].url,width:"100%",alt:e[0].filename});else{var t=[];for(i in e)t.push({src:e[i].url,_src:e[i].url,width:"100%",alt:e[i].filename});a.execCommand("insertimage",t)}},l)})}});var o=new UE.ui.Button({name:"插入图片",title:"插入图片",cssRules:"background-position: -726px -77px",onclick:function(){a.execCommand(t)}});return a.addListener("selectionchange",function(){var e=a.queryCommandState(t);-1==e?(o.setDisabled(!0),o.setChecked(!1)):(o.setDisabled(!1),o.setChecked(e))}),o},48),UE.registerUI("myinsertvideo",function(i,t){i.registerCommand(t,{execCommand:function(){require(["fileUploader"],function(e){e.show(function(e){if(e){var t=e.isRemote?"iframe":"video";i.execCommand("insertvideo",{url:e.url,width:300,height:200},t)}},{fileSizeLimit:512e4,type:"video",allowUploadVideo:!0})})}});var a=new UE.ui.Button({});return i.addListener("selectionchange",function(){var e=i.queryCommandState(t);-1==e?(a.setDisabled(!0),a.setChecked(!1)):(a.setDisabled(!1),a.setChecked(e))}),a},20),"undefined"!=typeof UE&&UE.delEditor("rich");var a=UE.getEditor("rich",e);a.ready(function(){var e=m.items[t].params.content;e=$.base64.decode(e),a.setContent(e),a.addListener("contentChange",function(){var e=a.getContent();e=$.base64.encode(e),$("#richtext").html(e).trigger("change")})})}},m.selectedItem=function(e){e&&("page"==(m.selected=e)?$("#page").trigger("click"):$(".drag[data-itemid='"+e+"']").addClass("selected"))},m.initWindow=function(){$(window).bind("scroll resize",function(){300<$(window).scrollTop()?$("#gotop").show():$("#gotop").hide(),$("#gotop").unbind("click").click(function(){$("body").animate({scrollTop:"0px"},1e3)})})},m.getNear=function(i){var a=[],o=0,l=0,n=0;$.each(m.items,function(e,t){(a[o]=e)==i&&(l=o-1,n=o+1),o++});var e=a[l],t=a[n];return t||(e||!1)},m.getItemNum=function(i){if(!i||!m.items)return-1;var a=0;return $.each(m.items,function(e,t){t.id==i&&a++}),a},m.getItemOnlyNum=function(i){if(!i||!m.items)return-1;var a=0;return $.each(m.items,function(e,t){t.only==i&&a++}),a},m.callbackGoods=function(e){if(e){var t=m.selected,i=m.childid;m.items[t].data[i]={title:e.title,thumb:e.thumb,price:e.minprice,gid:e.id,bargain:e.bargain,credit:e.credit,seecommission:e.seecommission,cansee:e.cansee,seetitle:e.seetitle},m.initItems(t),m.initEditor(!1),m.childid=null}else tip.msgbox.err("回调数据错误，请重试！")},m.callbackCategory=function(e){if(e){var t=m.selected;m.items[t].params.catename=e.name,m.items[t].params.cateid=e.id,m.items[t].params.groupname="",m.items[t].params.groupid="",m.initItems(t),m.initEditor(!1)}else tip.msgbox.err("回调数据错误，请重试！")},m.callbackGroup=function(e){if(e){var t=m.selected;m.items[t].params.groupname=e.name,m.items[t].params.groupid=e.id,m.items[t].params.catename="",m.items[t].params.cateid="",m.initItems(t),m.initEditor()}else tip.msgbox.err("回调数据错误，请重试！")},m.callbackCoupon=function(e){if(e){var t=m.selected,i=m.childid;m.items[t].data[i].price=e.values,m.items[t].data[i].desc=e.uselimit,m.items[t].data[i].couponid=e.id,m.items[t].data[i].name=e.couponname,m.initItems(t),m.initEditor(!1),m.childid=null}else tip.msgbox.err("回调数据错误，请重试！")},m.callbackData=function(e){if(e){var t=m.selected;m.childid;"topmenu"==m.items[t].id&&(m.items[t].params.datatype=e),m.initItems(t),m.initEditor(!1)}else tip.msgbox.err("回调数据错误，请重试！")},m.getId=function(e,t){return e+(+new Date+t)},m.length=function(e){if(void 0===e)return 0;var t=0;for(var i in e)t++;return t},m.save=function(i,a){if(void 0===i&&(i=!1),m.data={page:m.page,items:m.items},!m.page.title)return tip.msgbox.err("页面标题是必填项"),void $("#page").trigger("click");$(".btn-save").attr("stop",1).text("保存中..."),$.post(biz.url(0<m.id?"app/page/edit":"app/page/add"),{id:m.id,data:m.data,isdefault:i?1:0},function(e){if(2==a)var t="首页";else if(3==a)t="会员中心";else t="商品详情";$(".btn-save[data-type='save']").text("仅保存页面").removeAttr("stop"),$(".btn-save[data-type='isdefault']").text("保存并设为默认"+t).removeAttr("stop"),1==e.status?(tip.msgbox.suc(i?"保存成功并设为默认"+t+"！":"保存成功！"),e.result.id!=m.id&&setTimeout(function(){location.href=biz.url("app/page/edit",{id:e.result.id})},500),location.reload()):tip.msgbox.err(e.result.message)},"json")},m.cancel_default=function(){$.post(biz.url("app/page/cancel_default"),{id:m.id},function(e){1==e.status&&location.reload()},"json")},jQuery.base64=(jQuery,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",{decode:function(e){var t,i,a=0,o=e.length,l=[],n=[];if(e=String(e),0===o)return e;if(o%4!=0)throw"Cannot decode base64";for("="===e.charAt(o-1)&&(a=1,"="===e.charAt(o-2)&&(a=2),o-=4),t=0;t<o;t+=4)s(e,t),s(e,t+1),s(e,t+2),s(e,t+3),i=s(e,t)<<18|s(e,t+1)<<12|s(e,t+2)<<6|s(e,t+3),n.push(i>>16),n.push(i>>8&255),n.push(255&i),d(n,l);switch(a){case 1:i=s(e,t)<<18|s(e,t+1)<<12|s(e,t+2)<<6,n.push(i>>16),n.push(i>>8&255);break;case 2:i=s(e,t)<<18|s(e,t+1)<<12,n.push(i>>16)}if(d(n,l),0<n.length)throw"Cannot decode base64";return l.join("")},encode:function(e){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";if(0===(e=String(e)).length)return e;var t,i,a,o,l=[],n=[],s=e.length;for(t=0;t<s;){for(a=e.charCodeAt(t),o=l,a<128?o.push(a):(a<2048?o.push(192+(a>>6&31)):(o.push(224+(a>>12&15)),o.push(128+(a>>6&63))),o.push(128+(63&a)));3<=l.length;)i=l.shift()<<16|l.shift()<<8|l.shift(),n.push(r.charAt(i>>18)),n.push(r.charAt(i>>12&63)),n.push(r.charAt(i>>6&63)),n.push(r.charAt(63&i));t++}switch(l.length){case 1:i=l.shift()<<16,n.push(r.charAt(i>>18)+r.charAt(i>>12&63)+"==");break;case 2:i=l.shift()<<16|l.shift()<<8,n.push(r.charAt(i>>18)+r.charAt(i>>12&63)+r.charAt(i>>6&63)+"=")}return n.join("")},VERSION:"1.1"}),m});